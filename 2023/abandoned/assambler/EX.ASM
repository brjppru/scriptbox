		TITLE	EX.ASM
		PAGE	,132
		INCLUDE	DOS.INC

	STACK	SEGMENT PARA STACK 'STACK'

		DB	64 DUP('STACK')

	STACK ENDS
	DSEG	SEGMENT PARA PUBLIC 'DATA'

		FN	DB	"PIC.MY",0,"$"
		CNT	DB	1		
		FHANDLE	DW	?

	DSEG ENDS

	CSEG	SEGMENT PARA PUBLIC 'CODE'
		ASSUME CS:CSEG,DS:DSEG,SS:STACK

	ENTRY	PROC FAR
		
		PUSH 	DS
		SUB 	AX,AX
		PUSH 	AX
		MOV 	AX,DSEG
		MOV 	DS,AX
		
		@OpenFil FN,0		
		MOV 	FHANDLE,AX
		JC	E1		

		MOV	AX,0010H
		INT	10H

		MOV 	DX,3CEH
		MOV	AL,5
		OUT	DX,AL
		INC	DX
		MOV	AL,0
		OUT	DX,AL


		MOV	DX,3CEH
		MOV	AL,8
		OUT	DX,AL
		INC	DX
		MOV	AL,0
		OUT	DX,AL

F:		MOV	DX,3C4H
		MOV	AL,2
		OUT	DX,AL
		INC	DX
		MOV	AL,CNT
		OUT	DX,AL


		MOV 	AH,3FH
		MOV 	BX,FHANDLE
		PUSH 	DS
		MOV 	DX,0A000H	
		MOV	DS,DX
		SUB 	DX,DX
		MOV 	CX,08000H
		INT	21H
		POP	DS
		CMP 	CNT,04
		JE	E1
		SHL	CNT,01
		JMP	F



E1:		;@GetKey	
		;CMP	AL,00
		;JE	E1
		;@ClosFil FHANDLE
		RET

	ENTRY ENDP
    	CSEG ENDS
		END ENTRY   	